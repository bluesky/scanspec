


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Running a GraphQL service for generating points &mdash; scanspec 0.0+untagged.g41e1fe1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/graphiql@1.0.3/graphiql.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/scanspec-logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/react@16.13.1/umd/react.production.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/react-dom@16.13.1/umd/react-dom.production.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/graphiql@1.0.3/graphiql.min.js"></script>
        <script src="../_static/attachGraphiQL.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to Iterate a Spec" href="../how-to/iterate-a-spec.html" />
    <link rel="prev" title="Creating a Scan Spec" href="creating-a-spec.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: rgb(7, 43, 93)" >
          

          
            <a href="../index.html" class="icon icon-home"> scanspec
          

          
            
            <img src="../_static/scanspec-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    <style>
      /* style mobile top nav to look like main nav */
      .wy-nav-top {
          background: rgb(7, 43, 93)
      }
    </style>
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="creating-a-spec.html">Creating a Scan Spec</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running a GraphQL service for generating points</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-the-server">Running the server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#validating-a-spec">Validating a Spec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-points-from-a-spec">Getting Points from a Spec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#content-to-move">Content to move</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how-to/iterate-a-spec.html">How to Iterate a Spec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/serialize-a-spec.html">How to Serialize and Deserialize a Spec</a></li>
</ul>
<p class="caption"><span class="caption-text">Explanations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../explanations/what-are-dimensions.html">What are Dimensions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanations/why-squash-can-change-path.html">Why Squash (and Mask) can change the Path</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/contributing.html">Contributing</a></li>
</ul>

            
          
    <!-- Include Index in the sidebar -->
    <!-- https://stackoverflow.com/a/37843854 -->
    <a href="../genindex.html">Index</a>
    <!-- Include all versions of the docs -->
    <!-- https://holzhaus.github.io/sphinx-multiversion/master/templates.html -->
    
    <p class="caption"><span class="caption-text">Versions</span></p>
    <ul>
      <li><a href="graphql-service.html">master</a></li>
      <li><a href="../../0.2/index.html">0.2</a></li>
      <li><a href="../../0.1.1/index.html">0.1.1</a></li>
      <li><a href="../../0.1/index.html">0.1</a></li>
    </ul>
    
  
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">scanspec</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Running a GraphQL service for generating points</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorials/graphql-service.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-a-graphql-service-for-generating-points">
<span id="graphql-service"></span><h1>Running a GraphQL service for generating points<a class="headerlink" href="#running-a-graphql-service-for-generating-points" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="creating-a-spec.html"><span class="doc">Creating a Scan Spec</span></a> tutorial shows how you would use the commandline client to
plot a <a class="reference internal" href="../reference/api.html#scanspec.specs.Spec" title="scanspec.specs.Spec"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Spec</span></code></a>. This maps nicely to using scanspec in a commanline utility, but
not if you want to expose those points to a web GUI. To do this we will bring up
a <a class="reference external" href="https://www.graphql.com/">GraphQL</a> service that allows a web GUI to request the points it would like to
plot.</p>
<div class="section" id="running-the-server">
<h2>Running the server<a class="headerlink" href="#running-the-server" title="Permalink to this headline">¶</a></h2>
<p>In a terminal, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ scanspec service --cors
======== Running on http://0.0.0.0:8080 ========
(Press CTRL+C to quit)
</pre></div>
</div>
<p>You can now open a browser to <a class="reference external" href="http://0.0.0.0:8080/graphql">http://0.0.0.0:8080/graphql</a> and see a <a class="reference external" href="https://github.com/graphql/graphiql/tree/main/packages/graphiql#readme">GraphiQL</a> editor
which will allow you to send GraphQL queries to the server</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the examples below will embed a <a class="reference external" href="https://github.com/graphql/graphiql/tree/main/packages/graphiql#readme">GraphiQL</a> editor in your browser talking
to the scanspec service, they are live and you can modify the queries and press
the play button to get an updated response from the server. If the server is
not running (or you didn’t pass <code class="docutils literal notranslate"><span class="pre">--cors</span></code> to it) then the play button will not
be visible.</p>
</div>
</div>
<div class="section" id="validating-a-spec">
<h2>Validating a Spec<a class="headerlink" href="#validating-a-spec" title="Permalink to this headline">¶</a></h2>
<p>The first use case for our service is producing the canonical serialization of a
Spec. Some of the Specs like <a class="reference internal" href="../reference/api.html#scanspec.specs.Line.bounded" title="scanspec.specs.Line.bounded"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Line.bounded</span></code></a> will return an instance of Line that
has different parameters to those that are passed.</p>
<p>For example, on the commandline we might do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scanspec.specs</span> <span class="kn">import</span> <span class="n">Line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Line</span><span class="o">.</span><span class="n">bounded</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">serialize</span><span class="p">()</span>
<span class="go">{&#39;Line&#39;: {&#39;key&#39;: &#39;x&#39;, &#39;start&#39;: 0.1, &#39;stop&#39;: 0.9, &#39;num&#39;: 5}}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../how-to/serialize-a-spec.html#serialize-a-spec"><span class="std std-ref">How to Serialize and Deserialize a Spec</span></a></p>
</div>
<p>The equivalent in our service is:</p>

<style>
.graphiql {
    height: 325px;
    margin: 0 0 24px 0;
}
.graphiql-container .secondary-editor, .graphiql-container .toolbar,
.graphiql-ro .execute-button, .graphiql-ro .docExplorerShow {
    display: none
}
</style>
<div id="graphiql" class="graphiql">
    Loading GraphiQL...
    <div class="query">
{
  validateSpec(
    spec: {
      BoundedLine: {
        key: "x"
        lower: 0
        upper: 1
        num: 5
      }
    }
  )
}
    </div>
    <div class="response">
{
  "data": {
    "validateSpec": {
      "Line": {
        "key": "x",
        "start": 0.1,
        "stop": 0.9,
        "num": 5
      }
    }
  }
}
    </div>
    <script>
        attachGraphiQL(document.currentScript.parentNode, "http://localhost:8080/graphql");
    </script>
</div>
</div>
<div class="section" id="getting-points-from-a-spec">
<h2>Getting Points from a Spec<a class="headerlink" href="#getting-points-from-a-spec" title="Permalink to this headline">¶</a></h2>
<p>TODO</p>
</div>
<div class="section" id="content-to-move">
<h2>Content to move<a class="headerlink" href="#content-to-move" title="Permalink to this headline">¶</a></h2>
<p>When we move this sphinx extension into its own repo we will use the following to demo it:</p>

<style>
.graphiql {
    height: 325px;
    margin: 0 0 24px 0;
}
.graphiql-container .secondary-editor, .graphiql-container .toolbar,
.graphiql-ro .execute-button, .graphiql-ro .docExplorerShow {
    display: none
}
</style>
<div id="graphiql" class="graphiql">
    Loading GraphiQL...
    <div class="query">
{
  country(code: "BR") {
    name
    native
    capital
    emoji
    currency
    languages {
      code
      name
    }
  }
}
    </div>
    <div class="response">
{
  "data": {
    "country": {
      "name": "Brazil",
      "native": "Brasil",
      "capital": "Brasília",
      "emoji": "🇧🇷",
      "currency": "BRL",
      "languages": [
        {
          "code": "pt",
          "name": "Portuguese"
        }
      ]
    }
  }
}
    </div>
    <script>
        attachGraphiQL(document.currentScript.parentNode, "https://countries.trevorblades.com/");
    </script>
</div>

<style>
.graphiql {
    height: 325px;
    margin: 0 0 24px 0;
}
.graphiql-container .secondary-editor, .graphiql-container .toolbar,
.graphiql-ro .execute-button, .graphiql-ro .docExplorerShow {
    display: none
}
</style>
<div id="graphiql" class="graphiql">
    Loading GraphiQL...
    <div class="query">
{
  country(code: "BR") {
    name
    native
    capital
    emoji
    currency
    languages {
      code
      name
    }
  }
}
    </div>
    <div class="response">
{
  "data": {
    "country": {
      "name": "Brazil",
      "native": "Brasil",
      "capital": "Brasília",
      "emoji": "🇧🇷",
      "currency": "BRL",
      "languages": [
        {
          "code": "pt",
          "name": "Portuguese"
        }
      ]
    }
  }
}
    </div>
    <script>
        attachGraphiQL(document.currentScript.parentNode, undefined);
    </script>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../how-to/iterate-a-spec.html" class="btn btn-neutral float-right" title="How to Iterate a Spec" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="creating-a-spec.html" class="btn btn-neutral float-left" title="Creating a Scan Spec" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Diamond Light Source.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>